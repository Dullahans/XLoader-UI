(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-771331e4"],{"0d50":function(e,a,t){"use strict";t("783e")},"5e81":function(e,a,t){"use strict";t.r(a);t("14d9"),t("e9c4");var s=function(){var e=this,a=e._self._c;return a("div",{staticClass:"param-editor-page page-container"},[a("div",{staticClass:"page-header"},[e._m(0),a("div",{staticClass:"header-actions"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-check",loading:e.loading.params,disabled:!e.currentFile||!e.hasUnsavedChanges},on:{click:e.handleSave}},[e._v(" 保存参数 ")]),a("el-button",{attrs:{icon:"el-icon-upload2",disabled:!e.currentFile||!e.deviceConnected,loading:e.loading.sync},on:{click:e.handleSync}},[e._v(" 同步到设备 ")])],1)]),a("div",{staticClass:"editor-layout"},[a("aside",{staticClass:"file-sidebar"},[a("div",{staticClass:"sidebar-header"},[a("span",{staticClass:"sidebar-title"},[e._v("参数文件")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.loadFiles}})],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.files,expression:"loading.files"}],staticClass:"file-list"},[e._l(e.fileList,(function(t){return a("div",{key:t.name,staticClass:"file-item",class:{active:e.currentFile===t.name},on:{click:function(a){return e.openFile(t.name)}}},[a("i",{staticClass:"el-icon-document"}),a("span",{staticClass:"file-name"},[e._v(e._s(t.name))]),a("span",{staticClass:"file-size"},[e._v(e._s(e.formatSize(t.size)))])])})),0===e.fileList.length?a("div",{staticClass:"empty-tip"},[e._v(" 暂无参数文件 ")]):e._e()],2)]),a("main",{staticClass:"editor-main"},[e.currentFile?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.params,expression:"loading.params"}],staticClass:"param-form"},[a("div",{staticClass:"file-info-bar"},[a("div",{staticClass:"file-info"},[a("i",{staticClass:"el-icon-document"}),a("span",{staticClass:"current-filename"},[e._v(e._s(e.currentFile))]),e.hasUnsavedChanges?a("span",{staticClass:"modified-badge"},[e._v("已修改")]):e._e()]),a("div",{staticClass:"file-actions"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.handleReset}},[a("i",{staticClass:"el-icon-refresh-left"}),e._v(" 重置 ")])],1)]),a("div",{staticClass:"param-groups"},[e._l(e.paramGroups,(function(t){return a("div",{key:t.id,staticClass:"param-group card"},[a("div",{staticClass:"card-header"},[a("div",{staticClass:"group-info"},[a("h3",{staticClass:"card-title"},[e._v(e._s(t.name))]),a("p",{staticClass:"group-desc"},[e._v(e._s(t.description))])]),t.toggleable?a("el-switch",{attrs:{"active-text":"启用","inactive-text":"禁用"},model:{value:e.groupEnabled[t.id],callback:function(a){e.$set(e.groupEnabled,t.id,a)},expression:"groupEnabled[group.id]"}}):e._e()],1),a("div",{staticClass:"param-list"},e._l(t.params,(function(t){return a("div",{key:t.key,staticClass:"param-row"},[a("label",{staticClass:"param-label"},[e._v(" "+e._s(t.name)+" "),t.description?a("el-tooltip",{attrs:{content:t.description,placement:"top"}},[a("i",{staticClass:"el-icon-question param-help"})]):e._e()],1),"number"===t.type?a("el-input-number",{attrs:{min:t.min,max:t.max,step:t.step||1,precision:e.getPrecision(t.step),"controls-position":"right"},on:{change:function(a){return e.onParamChange(t.key,a)}},model:{value:e.editParams[t.key],callback:function(a){e.$set(e.editParams,t.key,a)},expression:"editParams[param.key]"}}):"select"===t.type?a("el-select",{on:{change:function(a){return e.onParamChange(t.key,a)}},model:{value:e.editParams[t.key],callback:function(a){e.$set(e.editParams,t.key,a)},expression:"editParams[param.key]"}},e._l(t.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1):"boolean"===t.type?a("el-switch",{on:{change:function(a){return e.onParamChange(t.key,a)}},model:{value:e.editParams[t.key],callback:function(a){e.$set(e.editParams,t.key,a)},expression:"editParams[param.key]"}}):a("el-input",{on:{input:function(a){return e.onParamChange(t.key,a)}},model:{value:e.editParams[t.key],callback:function(a){e.$set(e.editParams,t.key,a)},expression:"editParams[param.key]"}}),a("span",{staticClass:"param-unit"},[e._v(e._s(t.unit||""))])],1)})),0)])})),0===e.paramGroups.length&&e.currentFile?a("div",{staticClass:"raw-params card"},[e._m(1),a("pre",{staticClass:"raw-json"},[e._v(e._s(JSON.stringify(e.params,null,2)))])]):e._e()],2)]):a("div",{staticClass:"no-file-selected"},[a("i",{staticClass:"el-icon-folder-opened"}),a("p",[e._v("请从左侧选择一个参数文件进行编辑")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){return e.$router.push("/files")}}},[e._v(" 前往文件管理 ")])],1)])])])},i=[function(){var e=this,a=e._self._c;return a("div",{staticClass:"header-left"},[a("h1",{staticClass:"page-title"},[e._v("参数编辑")]),a("p",{staticClass:"page-subtitle"},[e._v("编辑仿真模型的接口参数配置")])])},function(){var e=this,a=e._self._c;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[e._v("原始参数数据")])])}],n=(t("e9f5"),t("7d54"),t("2f62")),r={name:"ParamEditor",data(){return{editParams:{},groupEnabled:{}}},computed:{...Object(n["c"])(["currentFile","params","fileList","hasUnsavedChanges","loading"]),...Object(n["b"])(["deviceConnected","paramGroups"])},watch:{params:{immediate:!0,deep:!0,handler(e){this.initEditParams(e)}}},mounted(){this.loadFiles(),this.$store.dispatch("loadParamSchema")},methods:{loadFiles(){this.$store.dispatch("loadFileList")},async openFile(e){if(this.hasUnsavedChanges)try{await this.$confirm("当前有未保存的更改，是否继续？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"})}catch{return}const a=await this.$store.dispatch("openFile",e);a.success||this.$message.error(a.error||"打开文件失败")},initEditParams(e){this.editParams={},this.paramGroups.forEach(a=>{a.params.forEach(a=>{this.editParams[a.key]=void 0!==e[a.key]&&null!==e[a.key]?e[a.key]:a.default})})},onParamChange(e,a){this.$store.commit("UPDATE_PARAM",{key:e,value:a})},async handleSave(){const e=await this.$store.dispatch("saveParams");e.success?this.$message.success("保存成功"):this.$message.error(e.error||"保存失败")},async handleSync(){const e=await this.$store.dispatch("syncToDevice");e.success?this.$message.success("同步成功"):this.$message.error(e.error||"同步失败")},async handleReset(){try{await this.$confirm("确定要重置所有参数吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await this.$store.dispatch("openFile",this.currentFile),this.$message.success("参数已重置")}catch{}},formatSize(e){return e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB"},getPrecision(e){if(!e)return 0;const a=e.toString(),t=a.indexOf(".");return-1===t?0:a.length-t-1}}},c=r,l=(t("0d50"),t("2877")),o=Object(l["a"])(c,s,i,!1,null,"5fd962d0",null);a["default"]=o.exports},"783e":function(e,a,t){}}]);